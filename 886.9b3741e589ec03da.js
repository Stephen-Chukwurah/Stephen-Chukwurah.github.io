"use strict";(self.webpackChunkice_comm=self.webpackChunkice_comm||[]).push([[886],{1886:(W,g,i)=>{i.r(g),i.d(g,{AdminModule:()=>j});var Z=i(7974),v=i(5017);class T extends v.o2{constructor(n){super(),this.observer$=n}connect(){return this.observer$}disconnect(){}}var r=i(4006),d=i(5412),e=i(4650),x=i(7185),p=i(2995),c=i(277),A=i(4859),_=i(9549),U=i(4144);let y=(()=>{class o{constructor(t,a,s,l,h,R){this.data=t,this.fb=a,this.toastr=s,this.apiService=l,this.dialog=h,this.coreFacade=R,this.form=new r.cw({}),this.processing=!1}ngOnInit(){this.initForm()}initForm(){this.form=this.fb.group({email:["",r.kI.required],username:["",r.kI.required],password:["",r.kI.required],firstname:["",r.kI.required],lastname:["",r.kI.required],city:["",r.kI.required],street:["",r.kI.required],number:["",r.kI.required],zipcode:["",r.kI.required],lat:["",r.kI.required],long:["",r.kI.required],phone:["",r.kI.required]}),this.data.inEditMode&&this.form.patchValue(this.patchPayload(this.data.payload))}onSubmit(){this.form.markAllAsTouched(),this.form.valid&&(this.data?.inEditMode?this.doUpdate():this.doCreate())}doCreate(){this.processing=!0,this.apiService.post("/users",this.setPayload(this.form.value)).subscribe(t=>{this.processing=!1,this.dialog.close(!0),this.toastr.success("Success!")},t=>{this.processing=!1,this.toastr.error("Error!")})}doUpdate(){this.processing=!0,this.apiService.put(`/users/${this.data.payload.id}`,this.setPayload(this.form.value)).subscribe(a=>{this.dialog.close(!0),this.processing=!1,this.toastr.success("Success!")},a=>{this.processing=!1,this.toastr.error("Error!")})}patchPayload(t){return{email:t?.email,username:t?.username,password:t?.password,firstname:t?.name?.firstname,lastname:t?.name?.lastname,city:t?.address?.city,street:t?.address?.street,number:t?.address?.number,zipcode:t?.address?.zipcode,lat:t?.address?.geolocation?.lat,long:t?.address?.geolocation?.long,phone:t?.phone}}setPayload(t){return{email:t?.email,username:t?.username,password:t?.password,name:{firstname:t?.firstname,lastname:t?.lastname},address:{city:t?.city,street:t?.street,number:t?.number,zipcode:t?.zipcode,geolocation:{lat:t?.lat,long:t?.long}},phone:t?.phone}}get businessId(){return this.form.get("businessId")}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(d.WI),e.Y36(r.qu),e.Y36(x._W),e.Y36(p.sM),e.Y36(d.so),e.Y36(p.CI))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-user-editor"]],decls:35,vars:4,consts:[["mat-dialog-title",""],[1,"mat-typography"],["novalidate","",1,"",3,"formGroup"],["fxLayout","row"],["fxFlexFill",""],[1,"w-100"],["matInput","","placeholder","Email","formControlName","email"],["matInput","","placeholder","Username","formControlName","username"],["matInput","","placeholder","Password","formControlName","password"],["matInput","","placeholder","Firstname","formControlName","firstname"],["matInput","","placeholder","Lastname","formControlName","lastname"],["matInput","","placeholder","City","formControlName","city"],["matInput","","placeholder","Street","formControlName","street"],["matInput","","placeholder","Number","formControlName","number"],["matInput","","placeholder","Zipcode","formControlName","zipcode"],["matInput","","placeholder","Latitude","formControlName","lat"],["matInput","","placeholder","Longitude","formControlName","long"],["matInput","","placeholder","Phone","formControlName","phone"],["align","end"],["mat-button","","mat-dialog-close",""],["mat-raised-button","","color","primary","cdkFocusInitial","",3,"disabled","click"]],template:function(t,a){1&t&&(e.TgZ(0,"h3",0),e._uU(1),e.qZA(),e.TgZ(2,"mat-dialog-content",1)(3,"form",2)(4,"div",3)(5,"div",4)(6,"mat-form-field",5),e._UZ(7,"input",6),e.qZA(),e.TgZ(8,"mat-form-field",5),e._UZ(9,"input",7),e.qZA(),e.TgZ(10,"mat-form-field",5),e._UZ(11,"input",8),e.qZA(),e.TgZ(12,"mat-form-field",5),e._UZ(13,"input",9),e.qZA(),e.TgZ(14,"mat-form-field",5),e._UZ(15,"input",10),e.qZA(),e.TgZ(16,"mat-form-field",5),e._UZ(17,"input",11),e.qZA(),e.TgZ(18,"mat-form-field",5),e._UZ(19,"input",12),e.qZA(),e.TgZ(20,"mat-form-field",5),e._UZ(21,"input",13),e.qZA(),e.TgZ(22,"mat-form-field",5),e._UZ(23,"input",14),e.qZA(),e.TgZ(24,"mat-form-field",5),e._UZ(25,"input",15),e.qZA(),e.TgZ(26,"mat-form-field",5),e._UZ(27,"input",16),e.qZA(),e.TgZ(28,"mat-form-field",5),e._UZ(29,"input",17),e.qZA()()()()(),e.TgZ(30,"mat-dialog-actions",18)(31,"button",19),e._uU(32,"Cancel"),e.qZA(),e.TgZ(33,"button",20),e.NdJ("click",function(){return a.onSubmit()}),e._uU(34),e.qZA()()),2&t&&(e.xp6(1),e.hij("",null!=a.data&&a.data.inEditMode?"Edit":"Create"," User"),e.xp6(2),e.Q6J("formGroup",a.form),e.xp6(30),e.Q6J("disabled",a.processing),e.xp6(1),e.Oqu(null!=a.data&&a.data.inEditMode?"Update":"Create"))},dependencies:[c.xw,c.s9,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,A.lW,_.KE,U.Nt,d.ZT,d.uh,d.xY,d.H8]}),o})();var C=i(6895),I=i(7392),f=i(9017),N=i(4850),u=i(3546),m=i(7155);function H(o,n){1&o&&(e.TgZ(0,"th",21),e._uU(1," Name "),e.qZA())}function b(o,n){if(1&o&&(e.TgZ(0,"td",22),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.AsE(" ",t.name.firstname," ",t.name.lastname,"")}}function q(o,n){1&o&&(e.TgZ(0,"th",21),e._uU(1," Username "),e.qZA())}function F(o,n){if(1&o&&(e.TgZ(0,"td",22),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",t.username," ")}}function Y(o,n){1&o&&(e.TgZ(0,"th",21),e._uU(1," Phone "),e.qZA())}function E(o,n){if(1&o&&(e.TgZ(0,"td",22),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",t.phone," ")}}function w(o,n){1&o&&(e.TgZ(0,"th",21),e._uU(1," Address "),e.qZA())}function M(o,n){if(1&o&&(e.TgZ(0,"td",22),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",t.address.city," ")}}function Q(o,n){1&o&&(e.TgZ(0,"th",21),e._uU(1," .. "),e.qZA())}function J(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"td",22)(1,"button",23)(2,"mat-icon"),e._uU(3,"more_horiz"),e.qZA()(),e.TgZ(4,"mat-menu",24,25)(6,"button",26),e.NdJ("click",function(){const l=e.CHM(t).$implicit,h=e.oxw(2);return e.KtG(h.openEditor(l,!0))}),e.TgZ(7,"mat-icon"),e._uU(8,"edit"),e.qZA(),e.TgZ(9,"span",27),e._uU(10,"Edit"),e.qZA()()()()}if(2&o){const t=e.MAs(5);e.xp6(1),e.Q6J("matMenuTriggerFor",t),e.xp6(3),e.Q6J("overlapTrigger",!1)}}function S(o,n){1&o&&e._UZ(0,"tr",28)}function D(o,n){1&o&&e._UZ(0,"tr",29)}const k=function(){return[10,20,30]};function O(o,n){if(1&o&&(e.TgZ(0,"div",3)(1,"table",10),e.ynx(2,11),e.YNc(3,H,2,0,"th",12),e.YNc(4,b,2,2,"td",13),e.BQk(),e.ynx(5,14),e.YNc(6,q,2,0,"th",12),e.YNc(7,F,2,1,"td",13),e.BQk(),e.ynx(8,15),e.YNc(9,Y,2,0,"th",12),e.YNc(10,E,2,1,"td",13),e.BQk(),e.ynx(11,16),e.YNc(12,w,2,0,"th",12),e.YNc(13,M,2,1,"td",13),e.BQk(),e.ynx(14,17),e.YNc(15,Q,2,0,"th",12),e.YNc(16,J,11,2,"td",13),e.BQk(),e.YNc(17,S,1,0,"tr",18),e.YNc(18,D,1,0,"tr",19),e.qZA(),e._UZ(19,"mat-paginator",20),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("dataSource",t.dataSource),e.xp6(16),e.Q6J("matHeaderRowDef",t.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns),e.xp6(1),e.Q6J("pageSizeOptions",e.DdM(4,k))}}function z(o,n){1&o&&(e.TgZ(0,"div",30),e._UZ(1,"div",31),e.qZA())}let P=(()=>{class o{constructor(t,a){this.coreFacade=t,this.dialog=a,this.displayedColumns=["name","username","phone","address","action"],this.dataSource=new T(this.coreFacade.user$)}ngOnInit(){this.coreFacade.loadUser()}ngAfterViewInit(){}openEditor(t,a){this.dialog.open(y,{data:{payload:t,inEditMode:a},width:"40rem"}).afterClosed().subscribe(l=>{l&&this.coreFacade.loadUser()})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.CI),e.Y36(d.uw))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-admin-home"]],viewQuery:function(t,a){if(1&t&&e.Gf(Z.NW,5),2&t){let s;e.iGM(s=e.CRH())&&(a.paginator=s.first)}},decls:15,vars:4,consts:[[1,"container","mt-5"],["fxLayout","row wrap","fxLayoutgap","0px",1,""],["fxFlex.xs","100","fxFlex.sm","100","fxFlex.md","100","fxFlex.lg","100","fxFlex.xl","100",1,"p-2"],[1,""],[1,"d-flex","justify-content-between","align-items-center","mb-2","mx-2"],[1,"m-0"],["mat-raised-button","","color","primary",3,"click"],["inset",""],["class","",4,"ngIf","ngIfElse"],["loading",""],["mat-table","",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","username"],["matColumnDef","phone"],["matColumnDef","address"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","",3,"matMenuTriggerFor"],[3,"overlapTrigger"],["toolbar","matMenu"],["mat-menu-item","",3,"click"],[1,"me-5"],["mat-header-row",""],["mat-row",""],[1,"loader","position-relative"],[1,"spinner"]],template:function(t,a){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-card",3)(4,"mat-card-header",4)(5,"mat-card-title",5),e._uU(6,"Users"),e.qZA(),e.TgZ(7,"button",6),e.NdJ("click",function(){return a.openEditor(null,!1)}),e._uU(8,"Add"),e.qZA()(),e._UZ(9,"mat-divider",7),e.TgZ(10,"mat-card-content"),e.YNc(11,O,20,5,"div",8),e.ALo(12,"async"),e.YNc(13,z,2,0,"ng-template",null,9,e.W1O),e.qZA()()()()()),2&t){const s=e.MAs(14);let l;e.xp6(11),e.Q6J("ngIf",null==(l=e.lcZ(12,2,a.coreFacade.user$))?null:l.length)("ngIfElse",s)}},dependencies:[C.O5,c.xw,c.yH,A.lW,I.Hw,f.VK,f.OP,f.p6,N.d,u.a8,u.dk,u.dn,u.n5,m.BZ,m.fO,m.as,m.w1,m.Dz,m.nj,m.ge,m.ev,m.XQ,m.Gk,Z.NW,C.Ov],styles:["table[_ngcontent-%COMP%]{width:100%}.loader[_ngcontent-%COMP%]{height:20rem}"]}),o})();var $=i(8252),B=i(7916);const L=[{path:"",component:P,data:{breadcrumb:"Admin"}}];let j=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[B.m,$.Bz.forChild(L)]}),o})()}}]);